# Dziennik Rutyn Eryka (Eryk’s Routine Journal)

![Project Status](https://img.shields.io/badge/status-in_development-yellow) ![License](https://img.shields.io/badge/license-TBD-lightgrey)

## Table of Contents
- [1. Project Description](#1-project-description)
- [2. Tech Stack](#2-tech-stack)
- [3. Getting Started Locally](#3-getting-started-locally)
- [4. Available Scripts](#4-available-scripts)
- [5. Project Scope](#5-project-scope)
- [6. Project Status](#6-project-status)
- [7. License](#7-license)
- [8. Product Documentation](#8-product-documentation)

## 1. Project Description
Eryk’s Routine Journal is a mobile-first web app that gamifies daily chores for an 11-year-old. The child interface highlights the active task within morning, afternoon, and evening routines, adds a non-stop timer, and rewards fast completion with bonus points, achievements, and a rewards shop. A companion parent panel lets caregivers configure routines, manage task and reward catalogs, and review progress dashboards, easing the burden of constant reminders. The architecture is designed to scale to multiple children and guardians.

## 2. Tech Stack
- **Frontend:** Next.js 15.5 (React 19) with TypeScript 5, Tailwind CSS 4, and planned shadcn/ui patterns for reusable components.
- **Backend & Data:** Supabase (PostgreSQL, Auth, Edge Functions) with Row Level Security policies for future multi-user isolation.
- **AI & Integrations:** OpenRouter API for optional AI-powered assistance once activated.
- **Infrastructure & DevOps:** GitHub Actions for CI/CD, DigitalOcean App Platform or Droplets for hosting, Supabase Cloud for managed data services.
- **Tooling:** ESLint 9 (Next.js config) and Prettier for linting/formatting, Turbopack-powered Next scripts, Playwright earmarked for cross-browser E2E testing, npm (lockfile present) with pnpm support.

## 3. Getting Started Locally
1. **Prerequisites:** Node.js 20+ (aligns with Next.js 15 requirements). Install pnpm or npm; npm is used by the existing lockfile.
2. **Install dependencies:**
   ```bash
   npm install
   # or
   pnpm install
   ```
3. **Configure environment:** Duplicate `.env.example` to `.env.local` and adjust values as needed. The defaults match the local Supabase stack (`http://127.0.0.1:54321`) and include the publishable and service role keys emitted by `supabase start`. Add optional secrets (e.g. `OPENROUTER_API_KEY`) when you enable those integrations.
4. **Run Supabase locally:** Start the containers and apply migrations. The command is idempotent and can stay running in the background.
  ```bash
  npm run supabase:start
  ```
  After Supabase finishes booting, refresh the generated database types whenever migrations change:
  ```bash
  npm run supabase:types
  ```
  > Jeśli podczas uruchamiania dev servera zobaczysz w logach komunikaty typu `TypeError: fetch failed` / `ECONNREFUSED 127.0.0.1:54321` lub `AuthRetryableFetchError`, oznacza to jedynie, że Supabase nie działa i żądania do `http://127.0.0.1:54321` są odrzucane – upewnij się, że powyższy proces `npm run supabase:start` jest uruchomiony i gotowy, a logi znikną.
5. **Run the dev server:**
   ```bash
   npm run dev
   ```
   The app is available at `http://localhost:3000`. The current layout is rooted in `src/app`.

### Running Playwright tests

Playwright configuration lives in `playwright.config.ts` and looks for E2E specs inside `tests/e2e/**\/*.e2e.ts`.  
To execute the suite locally:

1. Ensure the dev server (or Supabase-powered backend) is available. The config will automatically launch `npm run dev` unless `PLAYWRIGHT_BASE_URL` points to an already running instance.
2. Provide Supabase credentials for provisioning test users. At minimum, set either:
   - `PLAYWRIGHT_SUPABASE_URL` + `PLAYWRIGHT_SUPABASE_SERVICE_ROLE_KEY`, or
   - reuse `NEXT_PUBLIC_SUPABASE_URL` + `SUPABASE_SERVICE_ROLE_KEY`.
   Optional overrides can be stored in `.env.test`.
3. Run the tests:
   ```bash
   npm run test:e2e
   # or in watch/debug mode
   npm run test:e2e:ui
   ```

The Playwright report is saved to `playwright-report/` and can be reopened with `npm run test:e2e:report`.

## 4. Available Scripts
- `npm run dev` – Launches the Turbopack development server with fast refresh.
- `npm run build` – Produces an optimized production build.
- `npm run start` – Starts the production server after a build.
- `npm run lint` – Runs ESLint with the Next.js ruleset; resolve warnings before opening a PR.
- `npm run test:e2e` – Executes the Playwright end-to-end suite against the local dev server.
- `npm run test:e2e:ui` – Opens Playwright UI mode for exploratory debugging of E2E scenarios.
- `npm run test:e2e:report` – Re-opens the last HTML report generated by Playwright.
- `npm run supabase:start` – Boots the local Supabase stack (Postgres, Studio, Auth, Storage).
- `npm run supabase:stop` – Stops the local Supabase containers when you are done working.
- `npm run supabase:types` – Regenerates TypeScript definitions from the local database schema.

## 5. Project Scope
- **In scope for MVP:** Parent onboarding, CRUD for routines/tasks/rewards, dashboard with daily progress and history, child routine flow with highlighted tasks, irreversible timer, scoring system, achievements, and reward redemption experience.
- **Prepared for later phases:** Multi-child accounts, richer analytics, AI nudges, voice assistant, offline mode, automation rules, printable summaries, and marketplace integrations remain outside the initial release.

## 6. Project Status
The project is in active development, transitioning from product specification to implementation. Core UI scaffolding exists in Next.js, while Supabase integration, shadcn/ui components, automated tests (Playwright/Jest), and CI pipelines are scheduled next. Document gaps (e.g., test coverage expectations, finalized Node version) should be resolved as the MVP matures.

## 7. License
The license is not yet specified. All rights reserved until an explicit license is added to the repository.

## 8. Product Documentation
Planning artifacts live in the hidden `.ai/` directory for AI collaboration, but you can open them locally just like any other Markdown file:

- [Product Requirements Document](.ai/prd.md) – personas, user stories, and success metrics.
- [API Plan](.ai/api-plan.md) – proposed endpoints, payloads, and security notes.
- [Database Plan](.ai/db-plan.md) – entity list plus migration considerations.
- [Tech Stack Notes](.ai/tech-stack.md) – architectural decisions and trade-offs.
- [UI Plan](.ai/ui-plan.md) – component-level UX direction and states.
- [View Implementation Plan](.ai/view-implementation-plan.md) – work breakdown for upcoming screens.
